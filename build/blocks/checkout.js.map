{"version":3,"file":"blocks/checkout.js","mappings":"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","sources":["webpack://deliver-with-econt-woc-blocks/./src/blocks/checkout/EcontDelivery.js","webpack://deliver-with-econt-woc-blocks/external window [\"wp\",\"data\"]","webpack://deliver-with-econt-woc-blocks/external window [\"wp\",\"element\"]","webpack://deliver-with-econt-woc-blocks/external window [\"wp\",\"hooks\"]","webpack://deliver-with-econt-woc-blocks/external window [\"wp\",\"i18n\"]","webpack://deliver-with-econt-woc-blocks/external window [\"wp\",\"plugins\"]","webpack://deliver-with-econt-woc-blocks/external window \"React\"","webpack://deliver-with-econt-woc-blocks/external window \"ReactDOM\"","webpack://deliver-with-econt-woc-blocks/webpack/bootstrap","webpack://deliver-with-econt-woc-blocks/webpack/runtime/compat get default export","webpack://deliver-with-econt-woc-blocks/webpack/runtime/define property getters","webpack://deliver-with-econt-woc-blocks/webpack/runtime/hasOwnProperty shorthand","webpack://deliver-with-econt-woc-blocks/webpack/runtime/make namespace object","webpack://deliver-with-econt-woc-blocks/./src/blocks/checkout/index.js"],"sourcesContent":["\"use client\"\nimport { useState, useEffect, useRef } from \"@wordpress/element\"\nimport { useSelect, useDispatch } from \"@wordpress/data\"\nimport { applyFilters } from \"@wordpress/hooks\"\nimport { createPortal } from \"react-dom\"\n\nconst EcontDelivery = () => {\n    // Debug mode check - looks for ?econt_debug=1 in URL\n    const isDebugMode = () => {\n        const urlParams = new URLSearchParams(window.location.search)\n        return urlParams.get(\"econt_debug\") === \"1\" || urlParams.get(\"econt_debug\") === \"true\"\n    }\n\n    // Debug logging function\n    const debugLog = (category, message, data = null) => {\n        if (!isDebugMode()) return\n\n        const timestamp = new Date().toISOString().split(\"T\")[1].split(\".\")[0]\n        const prefix = `[ECONT-${category}] ${timestamp}:`\n\n        if (data) {\n            console.group(prefix, message)\n            console.log(\"Data:\", data)\n            console.groupEnd()\n        } else {\n            console.log(prefix, message)\n        }\n    }\n\n    // Component instance counter for debugging\n    const instanceId = useRef(Math.random().toString(36).substr(2, 9))\n    debugLog(\"INIT\", `EcontDelivery component initializing - Instance: ${instanceId.current}`)\n\n    // Declare jQuery and wp variables\n    const jQuery = window.jQuery\n    const wp = window.wp\n\n    // Helper function to get translation or fallback to the key\n    const getTranslation = (key) => {\n        if (typeof window.econtTranslations !== \"undefined\" && window.econtTranslations[key]) {\n            return window.econtTranslations[key]\n        }\n        return key\n    }\n\n    // Helper function to get custom selectors from window object\n    const getCustomSelectors = () => {\n        return window.econtCustomSelectors || {\n            customerDetails: '#customer_details',\n            shippingOptions: ['#shipping-option', '.wc-block-components-shipping-rates-control', '.shipping_method', '.woocommerce-shipping-methods', '#shipping_method'],\n            placeOrderButton: ['#place_order', '.wc-block-components-checkout-place-order-button'],\n            additionalFields: '.woocommerce-additional-fields',\n            checkoutForm: ['form[name=\"checkout\"]', 'form.woocommerce-checkout']\n        }\n    }\n\n    // Component state\n    const [iframeUrl, setIframeUrl] = useState(\"\")\n    const [globalShipmentPrices, setGlobalShipmentPrices] = useState({\n        cod: undefined,\n        cod_e: undefined,\n        no_cod: undefined,\n    })\n    const [isEditing, setIsEditing] = useState(true)\n    const [localShippingMethod, setLocalShippingMethod] = useState(null)\n    const [isEcontSelected, setIsEcontSelected] = useState(false)\n    const [portalContainer, setPortalContainer] = useState(null)\n    const [isOrderButtonDisabled, setIsOrderButtonDisabled] = useState(false)\n    const [isIframeLoading, setIsIframeLoading] = useState(true)\n\n    // Refs\n    const isMountedRef = useRef(true)\n    const messageListenerRef = useRef(null)\n    const econtContainerRef = useRef(null)\n    const ajaxInProgressRef = useRef(false) // Prevent duplicate AJAX requests\n    const lastFormDataRef = useRef(null) // Track last form data to prevent duplicates\n\n    // Get data from WooCommerce store\n    const { billingData, shippingData, cartData, selectedShippingMethod } = useSelect((select) => {\n        debugLog(\"STORE\", `useSelect hook called - Instance: ${instanceId.current}`)\n        const store = select(\"wc/store/cart\")\n        if (!store) {\n            return {\n                billingData: {},\n                shippingData: {},\n                cartData: {},\n                selectedShippingMethod: null,\n            }\n        }\n\n        let billing = {},\n            shipping = {},\n            cart = {},\n            shippingMethod = null\n\n        try {\n            // Try new API first\n            billing = store.getCustomerData()?.billing || {}\n            shipping = store.getCustomerData()?.shipping || {}\n            const cartData = store.getCartData()\n\n            // Calculate total weight from cart items\n            const totalWeight = cartData.itemsWeight * 0.001\n            const finalWeight = totalWeight > 0 ? totalWeight : 1\n\n            cart = {\n                total: Number.parseFloat(cartData.totals?.total_items) / 100 || 0,\n                currency: store.getCartTotals()?.currency_code || \"BGN\",\n                weight: finalWeight,\n            }\n\n            const shippingRates = store.getShippingRates()\n            shippingMethod = shippingRates?.[0]?.shipping_rates?.find((rate) => rate.selected)?.method_id\n        } catch (e) {\n            try {\n                // Fallback to older API\n                billing = store.getBillingData() || {}\n                shipping = store.getShippingData() || {}\n            } catch (e2) {\n                // Silently fail\n            }\n        }\n\n        return {\n            billingData: billing,\n            shippingData: shipping,\n            cartData: cart,\n            selectedShippingMethod: shippingMethod,\n        }\n    }, [])\n\n    const { setBillingAddress, setShippingAddress } = useDispatch(\"wc/store/cart\")\n\n    // Function to check if Econt shipping is selected\n    const isEcontShippingSelected = () => {\n        // First check the local state\n        if (localShippingMethod && localShippingMethod.includes(\"econt\")) {\n            debugLog(\"CHECK\", \"Econt found in local shipping method\", localShippingMethod)\n            return true\n        }\n\n        // Then check the store state\n        if (\n            selectedShippingMethod &&\n            (selectedShippingMethod === \"delivery_with_econt\" || selectedShippingMethod.includes(\"econt\"))\n        ) {\n            debugLog(\"CHECK\", \"Econt found in selected shipping method\", selectedShippingMethod)\n            return true\n        }\n\n        // Check the DOM directly\n        const econtRadio = document.querySelector('input[name^=\"shipping_method\"][value*=\"econt\"]:checked')\n        if (econtRadio) {\n            debugLog(\"CHECK\", \"Econt radio button found checked in DOM\", econtRadio.value)\n            return true\n        }\n\n        // Check if we have an iframe URL\n        if (iframeUrl && iframeUrl.length > 0) {\n            debugLog(\"CHECK\", \"Econt detected via iframe URL\", iframeUrl)\n            return true\n        }\n\n        return false\n    }\n\n    // Function to find the shipping option container\n    const findShippingOptionContainer = () => {\n\n        const customSelectors = getCustomSelectors()\n        const selectors = Array.isArray(customSelectors.shippingOptions)\n            ? customSelectors.shippingOptions\n            : [customSelectors.shippingOptions]\n\n        for (const selector of selectors) {\n            const element = document.querySelector(selector)\n            if (element) {\n                debugLog(\"DOM\", `Found shipping container with selector: ${selector}`)\n                return element\n            }\n        }\n\n        debugLog(\"DOM\", \"No shipping container found\")\n        return null\n    }\n\n    // Function to create a portal container after shipping options\n    const createPortalContainerAfterShippingOption = () => {\n        if (!isMountedRef.current) return null\n\n        // Find the shipping option element\n        const targetElement = findShippingOptionContainer()\n        if (!targetElement) return null\n\n        // Check if we already have a portal container\n        let container = document.getElementById(\"econt-portal-container\")\n\n        // If no container exists, create one\n        if (!container) {\n            debugLog(\"PORTAL\", \"Creating new portal container\")\n            container = document.createElement(\"div\")\n            container.id = \"econt-portal-container\"\n            // Insert after the shipping option\n            if (targetElement.nextSibling) {\n                targetElement.parentNode.insertBefore(container, targetElement.nextSibling)\n            } else {\n                targetElement.parentNode.appendChild(container)\n            }\n        } else {\n            debugLog(\"PORTAL\", \"Using existing portal container\")\n        }\n\n        return container\n    }\n\n    // Function to disable/enable the place order button\n    const togglePlaceOrderButton = (disable) => {\n        debugLog(\"BUTTON\", `Toggling place order button - disable: ${disable}`)\n\n        const customSelectors = getCustomSelectors()\n        const selectors = Array.isArray(customSelectors.placeOrderButton)\n            ? customSelectors.placeOrderButton\n            : [customSelectors.placeOrderButton]\n\n        let placeOrderButton = null\n\n        // Try to find the button using custom selectors\n        for (const selector of selectors) {\n            placeOrderButton = document.querySelector(selector)\n            if (placeOrderButton) {\n                debugLog(\"BUTTON\", `Found place order button with selector: ${selector}`)\n                break\n            }\n        }\n\n        if (placeOrderButton) {\n            placeOrderButton.disabled = disable\n\n            // Add visual indication that the button is disabled\n            if (disable) {\n                placeOrderButton.style.opacity = \"0.5\"\n                placeOrderButton.style.cursor = \"not-allowed\"\n                placeOrderButton.title = getTranslation(\"Please complete Econt delivery details first\")\n            } else {\n                placeOrderButton.style.opacity = \"\"\n                placeOrderButton.style.cursor = \"\"\n                placeOrderButton.title = \"\"\n            }\n\n            setIsOrderButtonDisabled(disable)\n        }\n    }\n\n    // Function to get data from form and make AJAX request\n    const getDataFromForm = async () => {\n        debugLog(\"FORM\", `Getting data from form - Instance: ${instanceId.current}`)\n\n        if (!isMountedRef.current || !isEcontShippingSelected()) {\n            debugLog(\"FORM\", \"Component not mounted or Econt not selected, skipping\")\n            return\n        }\n\n        // Prevent duplicate AJAX requests\n        if (ajaxInProgressRef.current) {\n            debugLog(\"FORM\", \"AJAX request already in progress, skipping\")\n            return\n        }\n\n        // Wait a moment for fields to be available\n        await new Promise((resolve) => setTimeout(resolve, 100))\n\n        // Get customer data from form\n        const customerData = {\n            first_name:\n                document.querySelector(\"#shipping-first_name\")?.value ||\n                document.querySelector(\"#billing-first_name\")?.value ||\n                \"\",\n            last_name:\n                document.querySelector(\"#shipping-last_name\")?.value ||\n                document.querySelector(\"#billing-last_name\")?.value ||\n                \"\",\n            company:\n                document.querySelector(\"#shipping-company\")?.value || document.querySelector(\"#billing-company\")?.value || \"\",\n            address_1:\n                document.querySelector(\"#shipping-address_1\")?.value ||\n                document.querySelector(\"#billing-address_1\")?.value ||\n                \"\",\n            city: document.querySelector(\"#shipping-city\")?.value || document.querySelector(\"#billing-city\")?.value || \"\",\n            postcode:\n                document.querySelector(\"#shipping-postcode\")?.value || document.querySelector(\"#billing-postcode\")?.value || \"\",\n            phone: document.querySelector(\"#shipping-phone\")?.value || document.querySelector(\"#billing-phone\")?.value || \"\",\n            email:\n                document.querySelector(\"#email\")?.value ||\n                document.querySelector(\"#shipping-email\")?.value ||\n                document.querySelector(\"#billing-email\")?.value ||\n                \"\",\n        }\n\n        debugLog(\"FORM\", \"Customer data extracted\", customerData)\n\n        // Check if we have enough data\n        if (!customerData.first_name || !customerData.city) {\n            debugLog(\"FORM\", \"Insufficient customer data, retrying in 1 second\")\n            if (isMountedRef.current) {\n                setTimeout(getDataFromForm, 1000)\n            }\n            return\n        }\n\n        // Process address information\n        let isOfficeDelivery = false\n        let officeName = \"\"\n        let streetAddress = \"\"\n\n        if (customerData.address_1) {\n            if (customerData.address_1.includes(\"Delivery to office:\")) {\n                isOfficeDelivery = true\n                officeName = customerData.address_1.replace(\"Delivery to office:\", \"\").trim()\n            } else if (customerData.address_1.includes(\"Delivery to address:\")) {\n                streetAddress = customerData.address_1.replace(\"Delivery to address:\", \"\").trim()\n            } else {\n                streetAddress = customerData.address_1\n            }\n        }\n\n        // Prepare request params\n        const params = {\n            customer_name: `${customerData.first_name} ${customerData.last_name}`.trim(),\n            customer_company: customerData.company,\n            customer_address: streetAddress,\n            customer_city_name: customerData.city,\n            customer_post_code: customerData.postcode,\n            customer_phone: customerData.phone,\n            customer_email: customerData.email,\n            office_name: isOfficeDelivery ? officeName : \"\",\n        }\n\n        // Remove empty values\n        Object.keys(params).forEach((key) => {\n            if (!params[key]) delete params[key]\n        })\n\n        // Add cart data\n        const cartParams = {\n            ...params,\n            order_total: cartData.total || 0,\n            order_currency: cartData.currency || \"BGN\",\n            pack_count: 1,\n            order_weight: cartData.weight,\n        }\n\n        // Check if this is the same as the last request to prevent duplicates\n        const formDataString = JSON.stringify(cartParams)\n        if (lastFormDataRef.current === formDataString) {\n            debugLog(\"FORM\", \"Same form data as last request, skipping AJAX\")\n            return\n        }\n\n        lastFormDataRef.current = formDataString\n        ajaxInProgressRef.current = true\n\n        try {\n            debugLog(\"AJAX\", \"Making AJAX request\", cartParams)\n\n            // Make AJAX request\n            if (typeof jQuery !== \"undefined\") {\n                // Set loading state when making the request\n                setIsIframeLoading(true)\n\n                const response = await jQuery.ajax({\n                    type: \"POST\",\n                    url: window.econtData.ajaxUrl,\n                    dataType: \"json\",\n                    data: {\n                        action: \"woocommerce_delivery_with_econt_get_orderinfo\",\n                        security: window.econtData.nonce,\n                        params: cartParams,\n                    },\n                })\n\n                debugLog(\"AJAX\", \"AJAX response received\", response)\n\n                if (!response) {\n                    debugLog(\"AJAX\", \"No response received\")\n                    return\n                }\n\n                // Process URL\n                let url\n                if (typeof response === \"string\") {\n                    url = response.split('\"').join(\"\").replace(/\\\\\\//g, \"/\")\n                } else if (typeof response === \"object\") {\n                    url = response.toString()\n                } else {\n                    debugLog(\"AJAX\", \"Invalid response type\")\n                    return\n                }\n\n                // Set locale and build full URL\n                const locale = document.documentElement.lang.split(\"-\")[0] || \"en\"\n                const validLocales = [\"bg\", \"en\", \"gr\", \"ro\"]\n                const fullUrl = `${url}&module=onecheckout&lang=${validLocales.includes(locale) ? locale : \"bg\"}`\n\n                debugLog(\"AJAX\", \"Final URL constructed\", fullUrl)\n\n                // Update iframe with URL only if it's different\n                if (fullUrl !== iframeUrl) {\n                    updateIframeWithUrl(fullUrl, true)\n                } else {\n                    debugLog(\"IFRAME\", \"URL unchanged, skipping iframe update\")\n                    setIsIframeLoading(false)\n                }\n            }\n        } catch (error) {\n            debugLog(\"AJAX\", \"AJAX request failed\", error)\n            setIsIframeLoading(false)\n        } finally {\n            ajaxInProgressRef.current = false\n        }\n    }\n\n    // Function to update iframe URL and visibility\n    const updateIframeWithUrl = (url, isVisible = true) => {\n        debugLog(\"IFRAME\", `Updating iframe with URL: ${url}, visible: ${isVisible}`)\n\n        if (!isMountedRef.current) return\n\n        // Update state\n        setIframeUrl(url)\n        setIsIframeLoading(true)\n\n        // Apply URL to iframe element\n        setTimeout(() => {\n            if (!isMountedRef.current) return\n\n            const iframe = document.querySelector(\"#delivery_with_econt_iframe\")\n            if (iframe) {\n                debugLog(\"IFRAME\", \"Iframe element found, setting src\")\n                iframe.src = url\n\n                if (isVisible) {\n                    iframe.style.display = \"block\"\n                    iframe.style.visibility = \"visible\"\n                    iframe.style.height = \"500px\"\n                }\n\n                // Add load event listener\n                iframe.onload = () => {\n                    debugLog(\"IFRAME\", \"Iframe loaded successfully\")\n                    try {\n                        const iframeDocument = iframe.contentDocument || iframe.contentWindow?.document\n                        if (isMountedRef.current) {\n                            setIsIframeLoading(false)\n                        }\n                    } catch (error) {\n                        debugLog(\"IFRAME\", \"Cross-origin iframe loaded (expected)\", error.message)\n                        if (isMountedRef.current) {\n                            setIsIframeLoading(false)\n                        }\n                    }\n                }\n\n                // Add error event listener\n                iframe.onerror = () => {\n                    debugLog(\"IFRAME\", \"Iframe failed to load\")\n                    if (isMountedRef.current) {\n                        setIsIframeLoading(false)\n                    }\n                }\n            } else if (isMountedRef.current) {\n                debugLog(\"IFRAME\", \"Iframe element not found, creating portal container and retrying\")\n                const container = createPortalContainerAfterShippingOption()\n                if (container) {\n                    setPortalContainer(container)\n                }\n                setTimeout(() => {\n                    if (isMountedRef.current) {\n                        updateIframeWithUrl(url, isVisible)\n                    }\n                }, 500)\n            }\n        }, 100)\n    }\n\n    // Handle postMessage events from iframe\n    const handleIframeMessage = async (event) => {\n        const data = event.data\n\n        // Skip if not a submission event\n        if (data.shipment_error || data.shipping_price == null || isNaN(Number(data.shipping_price)) || !data.name) {\n            return\n        }\n\n        debugLog(\"MESSAGE\", \"Processing valid shipment data\", data)\n\n        try {\n            // Set cookie for shipping price\n            document.cookie = `econt_shippment_price=${data.shipping_price}; path=/`;\n            document.cookie = `econt_customer_info_id=${data.id}; path=/`\n\n            // Update shipping rate via AJAX\n            if (typeof jQuery !== \"undefined\") {\n                const response = await jQuery.ajax({\n                    type: \"POST\",\n                    url: window.econtData.ajaxUrl,\n                    dataType: \"json\",\n                    data: {\n                        action: \"woocommerce_delivery_with_econt_update_shipping\",\n                        security: window.econtData.nonce,\n                        shipping_data: {\n                            price: data.shipping_price,\n                            price_cod: data.shipping_price_cod,\n                            price_cod_e: data.shipping_price_cod_e,\n                            currency: data.shipping_price_currency_sign,\n                        },\n                    },\n                })\n\n                if (!response.success) {\n                    throw new Error(response.message || \"Failed to update shipping rate\")\n                }\n\n                // Store shipment prices\n                setGlobalShipmentPrices({\n                    cod: data.shipping_price_cod,\n                    cod_e: data.shipping_price_cod_e,\n                    no_cod: data.shipping_price,\n                })\n\n                // Trigger checkout update and close iframe\n                wp.data.dispatch(\"wc/store/cart\").invalidateResolutionForStoreSelector(\"getCartData\")\n                setIsEditing(false)\n\n                // Keep button disabled while updating\n                togglePlaceOrderButton(true)\n\n                // Wait for checkout to update\n                await new Promise((resolve) => setTimeout(resolve, 1000))\n\n                // Prepare address data\n                const addressData = {\n                    first_name: data.face ? data.face.split(\" \")[0] : data.name.split(\" \")[0],\n                    last_name: data.face ? data.face.split(\" \")[1] : data.name.split(\" \")[1],\n                    company: data.face ? data.name : \"\",\n                    address_1: data.address\n                        ? `${getTranslation(\"Delivery to address:\")} ${data.address}`\n                        : `${getTranslation(\"Delivery to office:\")} ${data.office_name_only}`,\n                    city: data.city_name,\n                    postcode: data.post_code,\n                    phone: data.phone,\n                    email: data.email,\n                }\n\n                // Update addresses and wait for completion\n                await updateAddressFields(addressData)\n\n                // Verify fields are actually updated before enabling button\n                const fieldsUpdated = await verifyFieldsUpdated(addressData)\n\n                if (fieldsUpdated) {\n                    // Wait a bit more for any form validation to complete\n                    await new Promise((resolve) => setTimeout(resolve, 500))\n\n                    // Enable submit button only after verification\n                    togglePlaceOrderButton(false)\n                    debugLog(\"MESSAGE\", \"All fields updated successfully, submit button enabled\")\n                } else {\n                    debugLog(\"MESSAGE\", \"Field update verification failed, keeping button disabled\")\n                    togglePlaceOrderButton(true)\n                }\n\n                setIsEditing(false)\n                setIsIframeLoading(false)\n            }\n        } catch (error) {\n            debugLog(\"MESSAGE\", \"Error processing message\", error)\n            setIsEditing(false)\n            setIsIframeLoading(false)\n            togglePlaceOrderButton(true)\n        }\n    }\n\n// Helper function to update address fields with proper error handling\n    const updateAddressFields = async (addressData) => {\n        try {\n            const store = wp.data.select(\"wc/store/cart\")\n            const dispatch = wp.data.dispatch(\"wc/store/cart\")\n\n            if (store && dispatch) {\n                await dispatch.setBillingAddress(addressData)\n                await dispatch.setShippingAddress(addressData)\n\n                // Wait for store to update\n                await new Promise((resolve) => setTimeout(resolve, 300))\n            } else {\n                // Direct field updates with jQuery\n                updateFieldsDirectly(addressData)\n            }\n        } catch (error) {\n            debugLog(\"MESSAGE\", \"WooCommerce store update failed, falling back to direct field updates\", error)\n            // Fallback to direct field updates\n            updateFieldsDirectly(addressData)\n        }\n    }\n\n// Helper function for direct field updates using custom selectors\n    const updateFieldsDirectly = (addressData) => {\n        if (typeof jQuery !== \"undefined\") {\n            const fields = [\"first_name\", \"last_name\", \"company\", \"address_1\", \"city\", \"postcode\", \"phone\", \"email\"]\n\n            fields.forEach((field) => {\n                // Try both shipping and billing fields\n                const shippingField = jQuery(`#shipping-${field}`)\n                const billingField = jQuery(`#billing-${field}`)\n\n                if (shippingField.length) {\n                    shippingField.val(addressData[field]).trigger('change')\n                }\n                if (billingField.length) {\n                    billingField.val(addressData[field]).trigger('change')\n                }\n            })\n\n            // Trigger form validation using custom form selector\n            const customSelectors = getCustomSelectors()\n            const formSelectors = Array.isArray(customSelectors.checkoutForm)\n                ? customSelectors.checkoutForm\n                : [customSelectors.checkoutForm]\n\n            for (const selector of formSelectors) {\n                const form = jQuery(selector)\n                if (form.length) {\n                    jQuery(document.body).trigger('update_checkout')\n                    break\n                }\n            }\n        }\n    }\n\n// Helper function to verify fields are actually updated\n    const verifyFieldsUpdated = async (expectedData) => {\n        if (typeof jQuery === \"undefined\") {\n            return false\n        }\n\n        const fields = [\"first_name\", \"last_name\", \"company\", \"address_1\", \"city\", \"postcode\", \"phone\", \"email\"]\n        let allFieldsUpdated = true\n\n        // Check multiple times with delays to account for async updates\n        for (let attempt = 0; attempt < 3; attempt++) {\n            allFieldsUpdated = true\n\n            for (const field of fields) {\n                const shippingField = jQuery(`#shipping-${field}`)\n                const billingField = jQuery(`#billing-${field}`)\n\n                const shippingValue = shippingField.length ? shippingField.val() : null\n                const billingValue = billingField.length ? billingField.val() : null\n                const expectedValue = expectedData[field] || \"\"\n\n                // Check if at least one field (shipping or billing) has the expected value\n                if (shippingField.length || billingField.length) {\n                    if (shippingValue !== expectedValue && billingValue !== expectedValue) {\n                        debugLog(\"MESSAGE\", `Field ${field} not updated. Expected: ${expectedValue}, Got shipping: ${shippingValue}, billing: ${billingValue}`)\n                        allFieldsUpdated = false\n                        break\n                    }\n                }\n            }\n\n            if (allFieldsUpdated) {\n                debugLog(\"MESSAGE\", \"All fields verified as updated\")\n                return true\n            }\n\n            // Wait before next attempt\n            await new Promise((resolve) => setTimeout(resolve, 200))\n        }\n\n        debugLog(\"MESSAGE\", \"Field verification failed after 3 attempts\")\n        return false\n    }\n\n    // Effect to check shipping method changes and update component state\n    useEffect(() => {\n        debugLog(\"EFFECT\", `Shipping method check effect triggered - Instance: ${instanceId.current}`)\n\n        // Check if shipping method has changed\n        const checkShippingMethod = () => {\n            const isEcont = isEcontShippingSelected()\n            setIsEcontSelected(isEcont)\n\n            // Update local shipping method if store method changes\n            if (selectedShippingMethod && selectedShippingMethod !== localShippingMethod) {\n                debugLog(\"EFFECT\", \"Updating local shipping method\", {\n                    old: localShippingMethod,\n                    new: selectedShippingMethod,\n                })\n                setLocalShippingMethod(selectedShippingMethod)\n            }\n\n            if (isEcont) {\n                debugLog(\"EFFECT\", \"Econt is selected, setting up portal and getting form data\")\n                // Create portal container if needed\n                const container = createPortalContainerAfterShippingOption()\n                if (container) {\n                    setPortalContainer(container)\n                }\n\n                // Set editing mode if needed\n                if (!iframeUrl) {\n                    setIsEditing(true)\n                    togglePlaceOrderButton(true)\n                }\n\n                getDataFromForm()\n            } else {\n                debugLog(\"EFFECT\", \"Econt not selected, enabling place order button\")\n                togglePlaceOrderButton(false)\n                setIsIframeLoading(false)\n            }\n        }\n\n        // Initial check\n        checkShippingMethod()\n\n        // Set up event listener for shipping method changes\n        const handleShippingMethodChange = () => {\n            debugLog(\"EVENT\", \"Shipping method change event triggered\")\n            checkShippingMethod()\n        }\n\n        // Add event listeners for shipping method changes\n        if (typeof jQuery !== \"undefined\") {\n            debugLog(\"EVENT\", \"Adding jQuery event listeners\")\n            jQuery(document.body).on(\"updated_checkout\", handleShippingMethodChange)\n            jQuery('input[name^=\"shipping_method\"]').on(\"change\", handleShippingMethodChange)\n        }\n\n        // Clean up event listeners\n        return () => {\n            debugLog(\"EVENT\", \"Cleaning up shipping method event listeners\")\n            if (typeof jQuery !== \"undefined\") {\n                jQuery(document.body).off(\"updated_checkout\", handleShippingMethodChange)\n                jQuery('input[name^=\"shipping_method\"]').off(\"change\", handleShippingMethodChange)\n            }\n        }\n    }, [selectedShippingMethod, localShippingMethod, billingData, shippingData, cartData, iframeUrl])\n\n    // Effect to update portal container when shipping method changes\n    useEffect(() => {\n        if (isEcontSelected) {\n            const container = createPortalContainerAfterShippingOption()\n            if (container) {\n                setPortalContainer(container)\n            }\n            // If Econt is selected but we don't have shipping data yet, disable the button\n            if (isEditing && !globalShipmentPrices.no_cod) {\n                togglePlaceOrderButton(true)\n            }\n        } else {\n            // If Econt is not selected, make sure the button is enabled\n            togglePlaceOrderButton(false)\n        }\n    }, [isEcontSelected, isEditing, globalShipmentPrices])\n\n    // Effect to set up message event listener\n    useEffect(() => {\n        debugLog(\"EFFECT\", `Setting up message event listener - Instance: ${instanceId.current}`)\n        messageListenerRef.current = handleIframeMessage\n        window.addEventListener(\"message\", handleIframeMessage)\n\n        return () => {\n            debugLog(\"EFFECT\", `Cleaning up message event listener - Instance: ${instanceId.current}`)\n            window.removeEventListener(\"message\", handleIframeMessage)\n            messageListenerRef.current = null\n        }\n    }, [])\n\n    // Effect to clean up on unmount\n    useEffect(() => {\n        return () => {\n            debugLog(\"CLEANUP\", `Component unmounting - Instance: ${instanceId.current}`)\n            isMountedRef.current = false\n\n            // Clean up any event listeners\n            if (typeof jQuery !== \"undefined\") {\n                jQuery(document.body).off(\"updated_checkout\")\n                jQuery('input[name^=\"shipping_method\"]').off(\"change\")\n            }\n\n            // Remove message event listener\n            if (messageListenerRef.current) {\n                window.removeEventListener(\"message\", messageListenerRef.current)\n                messageListenerRef.current = null\n            }\n\n            // Remove portal container\n            const container = document.getElementById(\"econt-portal-container\")\n            if (container) {\n                container.remove()\n            }\n\n            // Make sure the place order button is enabled when component unmounts\n            togglePlaceOrderButton(false)\n        }\n    }, [])\n\n    // Effect to handle checkout updates and ensure button state is correct\n    useEffect(() => {\n        const handleCheckoutUpdate = () => {\n            // If Econt is selected and we're still editing (no shipping data yet), disable the button\n            if (isEcontSelected && isEditing && !globalShipmentPrices.no_cod) {\n                togglePlaceOrderButton(true)\n            } else if (!isEcontSelected) {\n                // If Econt is not selected, make sure the button is enabled\n                togglePlaceOrderButton(false)\n            }\n        }\n\n        if (typeof jQuery !== \"undefined\") {\n            jQuery(document.body).on(\"updated_checkout\", handleCheckoutUpdate)\n        }\n\n        return () => {\n            if (typeof jQuery !== \"undefined\") {\n                jQuery(document.body).off(\"updated_checkout\", handleCheckoutUpdate)\n            }\n        }\n    }, [isEcontSelected, isEditing, globalShipmentPrices])\n\n    // Prepare section title and button text\n    const defaultSectionTitleText = getTranslation(\"Econt Delivery Details\")\n    const defaultEditButtonText = getTranslation(\"Edit delivery details\")\n    const sectionTitleText = applyFilters(\"econtDelivery.editButtonText\", defaultSectionTitleText)\n    const editButtonText = applyFilters(\"econtDelivery.checkoutButtonText\", defaultEditButtonText)\n\n    // Render component content\n    const renderContent = () => {\n        debugLog(\"RENDER\", `Rendering component content - Instance: ${instanceId.current}`, {\n            isEcontSelected,\n            isEditing,\n            isIframeLoading,\n            iframeUrl: iframeUrl ? \"present\" : \"empty\",\n        })\n\n        return (\n            <div\n                className=\"econt-content-wrapper\"\n                style={{\n                    display: isEcontSelected ? \"block\" : \"none\",\n                    visibility: isEcontSelected ? \"visible\" : \"hidden\",\n                }}\n            >\n                <h3>{sectionTitleText}</h3>\n                {/* Iframe container */}\n                <div\n                    className=\"econt-iframe-container\"\n                    style={{\n                        display: isEcontSelected && isEditing ? \"block\" : \"none\",\n                        visibility: isEcontSelected && isEditing ? \"visible\" : \"hidden\",\n                    }}\n                >\n                    {/* Loading message with spinner - always visible when loading */}\n                    {isEcontSelected && isEditing && isIframeLoading && (\n                        <div\n                            className=\"econt-loading\"\n                            style={{\n                                padding: \"20px\",\n                                marginBottom: \"20px\",\n                                backgroundColor: \"#f8f9fa\",\n                                border: \"1px solid #ddd\",\n                                borderRadius: \"4px\",\n                                textAlign: \"center\",\n                            }}\n                        >\n                            <div style={{ display: \"flex\", justifyContent: \"center\", alignItems: \"center\", marginBottom: \"10px\" }}>\n                                <div\n                                    className=\"econt-spinner\"\n                                    style={{\n                                        width: \"30px\",\n                                        height: \"30px\",\n                                        border: \"4px solid rgba(0, 0, 0, 0.1)\",\n                                        borderRadius: \"50%\",\n                                        borderTop: \"4px solid #3498db\",\n                                        animation: \"econt-spin 1s linear infinite\",\n                                    }}\n                                ></div>\n                            </div>\n                            <div>{getTranslation(\"Loading Econt delivery options...\")}</div>\n                            {/* Add CSS animation for the spinner */}\n                            <style>\n                                {`\n                                @keyframes econt-spin {\n                                    0% { transform: rotate(0deg); }\n                                    100% { transform: rotate(360deg); }\n                                }\n                                `}\n                            </style>\n                        </div>\n                    )}\n                    {/* Iframe - hidden initially and while loading */}\n                    <iframe\n                        src={iframeUrl || \"about:blank\"}\n                        id=\"delivery_with_econt_iframe\"\n                        style={{\n                            marginTop: \"2rem\",\n                            width: \"100%\",\n                            minHeight: \"600px\",\n                            border: \"none\",\n                            display: isEcontSelected && isEditing && iframeUrl && !isIframeLoading ? \"block\" : \"none\",\n                            visibility: isEcontSelected && isEditing && iframeUrl && !isIframeLoading ? \"visible\" : \"hidden\",\n                        }}\n                        onLoad={() => {\n                            debugLog(\"IFRAME\", \"Iframe onLoad event triggered\")\n                            if (!iframeUrl) return\n                            const iframe = document.getElementById(\"delivery_with_econt_iframe\")\n                            if (iframe && isEcontSelected && isEditing) {\n                                setIsIframeLoading(false)\n                                iframe.style.display = \"block\"\n                                iframe.style.visibility = \"visible\"\n                                debugLog(\"IFRAME\", \"Iframe made visible after load\")\n                            }\n                        }}\n                    />\n                </div>\n                {/* Edit button */}\n                {isEcontSelected && !isEditing && (\n                    <button\n                        type=\"button\"\n                        className=\"econt-button econt-button-details\"\n                        style={{\n                            display: \"block\",\n                            visibility: \"visible\",\n                            marginBottom: \"40px\",\n                        }}\n                        onClick={() => {\n                            debugLog(\"BUTTON\", \"Edit button clicked\")\n                            setIsEditing(true)\n                            setIsIframeLoading(true)\n                            togglePlaceOrderButton(true)\n                            if (isEcontSelected && !iframeUrl) {\n                                getDataFromForm()\n                            }\n                        }}\n                    >\n                        {editButtonText}\n                    </button>\n                )}\n                {/* Message about disabled place order button */}\n                {isEcontSelected && isOrderButtonDisabled && (\n                    <div\n                        className=\"econt-button-message\"\n                        style={{\n                            marginTop: \"10px\",\n                            padding: \"10px\",\n                            backgroundColor: \"#fff9c4\",\n                            border: \"1px solid #ffd600\",\n                            borderRadius: \"4px\",\n                            fontSize: \"14px\",\n                            textAlign: \"center\",\n                        }}\n                    >\n                        {getTranslation(\"Please complete Econt delivery details before placing your order\")}\n                    </div>\n                )}\n            </div>\n        )\n    }\n\n    // If we have a portal container and Econt is selected, render through portal\n    if (portalContainer && isEcontSelected) {\n        debugLog(\"RENDER\", `Rendering through portal - Instance: ${instanceId.current}`)\n        return createPortal(\n            <div\n                ref={econtContainerRef}\n                className=\"wp-block-econt-delivery\"\n                style={{\n                    position: \"relative\",\n                    zIndex: \"10\",\n                    display: \"block\",\n                    visibility: \"visible\",\n                    opacity: \"1\",\n                    marginTop: \"20px\",\n                    marginBottom: \"32px\",\n                }}\n                data-econt-component=\"true\"\n                data-econt-shipping-selected=\"true\"\n                data-econt-iframe-url={iframeUrl ? \"loaded\" : \"not-loaded\"}\n                data-econt-iframe-loading={isIframeLoading ? \"true\" : \"false\"}\n                data-econt-instance={instanceId.current}\n            >\n                {renderContent()}\n            </div>,\n            portalContainer,\n        )\n    }\n\n    // Fallback render method if portal is not available\n    debugLog(\"RENDER\", `Rendering fallback (no portal) - Instance: ${instanceId.current}`)\n    return (\n        <div\n            ref={econtContainerRef}\n            className=\"wp-block-econt-delivery\"\n            style={{\n                position: \"relative\",\n                zIndex: isEcontSelected ? \"10\" : \"-1\",\n                display: isEcontSelected ? \"block\" : \"none\",\n                visibility: isEcontSelected ? \"visible\" : \"hidden\",\n                opacity: isEcontSelected ? \"1\" : \"0\",\n            }}\n            data-econt-component=\"true\"\n            data-econt-shipping-selected={isEcontSelected ? \"true\" : \"false\"}\n            data-econt-iframe-url={iframeUrl ? \"loaded\" : \"not-loaded\"}\n            data-econt-iframe-loading={isIframeLoading ? \"true\" : \"false\"}\n            data-econt-instance={instanceId.current}\n        >\n            {renderContent()}\n        </div>\n    )\n}\n\nexport default EcontDelivery\n","module.exports = window[\"wp\"][\"data\"];","module.exports = window[\"wp\"][\"element\"];","module.exports = window[\"wp\"][\"hooks\"];","module.exports = window[\"wp\"][\"i18n\"];","module.exports = window[\"wp\"][\"plugins\"];","module.exports = window[\"React\"];","module.exports = window[\"ReactDOM\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { __ } from '@wordpress/i18n';\nimport { registerPlugin } from '@wordpress/plugins';\nimport { useSelect } from '@wordpress/data';\nimport EcontDelivery from './EcontDelivery';\n\nconst EcontShippingContent = () => {\n    const { isEcontShippingSelected } = useSelect((select) => {\n        const store = select('wc/store/cart');\n        if (!store) {\n            return { isEcontShippingSelected: false };\n        }\n\n        // Get shipping rates\n        const shippingRates = store.getShippingRates();\n\n        // Find selected shipping rate\n        const selectedRate = shippingRates?.[0]?.shipping_rates?.find(rate => rate.selected);\n\n        return {\n            isEcontShippingSelected: selectedRate?.method_id === 'delivery_with_econt'\n        };\n    }, []);\n\n    if (!isEcontShippingSelected) {\n        return null;\n    }\n\n    return <EcontDelivery />;\n};\n\nconsole.log('Registering Econt delivery block plugin');\n\nregisterPlugin('econt-delivery-block', {\n    render: EcontShippingContent,\n    scope: 'woocommerce-checkout'\n});"],"names":["createElement","useState","useEffect","useRef","useSelect","useDispatch","applyFilters","createPortal","EcontDelivery","isDebugMode","urlParams","URLSearchParams","window","location","search","get","debugLog","category","message","data","timestamp","Date","toISOString","split","prefix","console","group","log","groupEnd","instanceId","Math","random","toString","substr","current","jQuery","wp","getTranslation","key","econtTranslations","getCustomSelectors","econtCustomSelectors","customerDetails","shippingOptions","placeOrderButton","additionalFields","checkoutForm","iframeUrl","setIframeUrl","globalShipmentPrices","setGlobalShipmentPrices","cod","undefined","cod_e","no_cod","isEditing","setIsEditing","localShippingMethod","setLocalShippingMethod","isEcontSelected","setIsEcontSelected","portalContainer","setPortalContainer","isOrderButtonDisabled","setIsOrderButtonDisabled","isIframeLoading","setIsIframeLoading","isMountedRef","messageListenerRef","econtContainerRef","ajaxInProgressRef","lastFormDataRef","billingData","shippingData","cartData","selectedShippingMethod","select","store","billing","shipping","cart","shippingMethod","getCustomerData","getCartData","totalWeight","itemsWeight","finalWeight","total","Number","parseFloat","totals","total_items","currency","getCartTotals","currency_code","weight","shippingRates","getShippingRates","shipping_rates","find","rate","selected","method_id","e","getBillingData","getShippingData","e2","setBillingAddress","setShippingAddress","isEcontShippingSelected","includes","econtRadio","document","querySelector","value","length","findShippingOptionContainer","customSelectors","selectors","Array","isArray","selector","element","createPortalContainerAfterShippingOption","targetElement","container","getElementById","id","nextSibling","parentNode","insertBefore","appendChild","togglePlaceOrderButton","disable","disabled","style","opacity","cursor","title","getDataFromForm","Promise","resolve","setTimeout","customerData","first_name","last_name","company","address_1","city","postcode","phone","email","isOfficeDelivery","officeName","streetAddress","replace","trim","params","customer_name","customer_company","customer_address","customer_city_name","customer_post_code","customer_phone","customer_email","office_name","Object","keys","forEach","cartParams","order_total","order_currency","pack_count","order_weight","formDataString","JSON","stringify","response","ajax","type","url","econtData","ajaxUrl","dataType","action","security","nonce","join","locale","documentElement","lang","validLocales","fullUrl","updateIframeWithUrl","error","isVisible","iframe","src","display","visibility","height","onload","iframeDocument","contentDocument","contentWindow","onerror","handleIframeMessage","event","shipment_error","shipping_price","isNaN","name","cookie","shipping_data","price","price_cod","shipping_price_cod","price_cod_e","shipping_price_cod_e","shipping_price_currency_sign","success","Error","dispatch","invalidateResolutionForStoreSelector","addressData","face","address","office_name_only","city_name","post_code","updateAddressFields","fieldsUpdated","verifyFieldsUpdated","updateFieldsDirectly","fields","field","shippingField","billingField","val","trigger","formSelectors","form","body","expectedData","allFieldsUpdated","attempt","shippingValue","billingValue","expectedValue","checkShippingMethod","isEcont","old","new","handleShippingMethodChange","on","off","addEventListener","removeEventListener","remove","handleCheckoutUpdate","defaultSectionTitleText","defaultEditButtonText","sectionTitleText","editButtonText","renderContent","className","padding","marginBottom","backgroundColor","border","borderRadius","textAlign","justifyContent","alignItems","width","borderTop","animation","marginTop","minHeight","onLoad","onClick","fontSize","ref","position","zIndex","__","registerPlugin","EcontShippingContent","selectedRate","render","scope"],"sourceRoot":""}