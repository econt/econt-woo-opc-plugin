{"version":3,"file":"blocks/checkout.js","mappings":"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","sources":["webpack://deliver-with-econt-woc-blocks/./src/blocks/checkout/EcontDelivery.js","webpack://deliver-with-econt-woc-blocks/external window [\"wp\",\"data\"]","webpack://deliver-with-econt-woc-blocks/external window [\"wp\",\"element\"]","webpack://deliver-with-econt-woc-blocks/external window [\"wp\",\"hooks\"]","webpack://deliver-with-econt-woc-blocks/external window [\"wp\",\"i18n\"]","webpack://deliver-with-econt-woc-blocks/external window [\"wp\",\"plugins\"]","webpack://deliver-with-econt-woc-blocks/external window \"React\"","webpack://deliver-with-econt-woc-blocks/external window \"ReactDOM\"","webpack://deliver-with-econt-woc-blocks/webpack/bootstrap","webpack://deliver-with-econt-woc-blocks/webpack/runtime/compat get default export","webpack://deliver-with-econt-woc-blocks/webpack/runtime/define property getters","webpack://deliver-with-econt-woc-blocks/webpack/runtime/hasOwnProperty shorthand","webpack://deliver-with-econt-woc-blocks/webpack/runtime/make namespace object","webpack://deliver-with-econt-woc-blocks/./src/blocks/checkout/index.js"],"sourcesContent":["\"use client\"\nimport { useState, useEffect, useRef } from \"@wordpress/element\"\nimport { useSelect, useDispatch } from \"@wordpress/data\"\nimport { applyFilters } from \"@wordpress/hooks\"\nimport { createPortal } from \"react-dom\"\n\nconst EcontDelivery = () => {\n    // Debug mode check - looks for ?econt_debug=1 in URL\n    const isDebugMode = () => {\n        const urlParams = new URLSearchParams(window.location.search)\n        return urlParams.get(\"econt_debug\") === \"1\" || urlParams.get(\"econt_debug\") === \"true\"\n    }\n\n    // Debug logging function\n    const debugLog = (category, message, data = null) => {\n        if (!isDebugMode()) return\n\n        const timestamp = new Date().toISOString().split(\"T\")[1].split(\".\")[0]\n        const prefix = `[ECONT-${category}] ${timestamp}:`\n\n        if (data) {\n            console.group(prefix, message)\n            console.log(\"Data:\", data)\n            console.groupEnd()\n        } else {\n            console.log(prefix, message)\n        }\n    }\n\n    // Component instance counter for debugging\n    const instanceId = useRef(Math.random().toString(36).substr(2, 9))\n    debugLog(\"INIT\", `EcontDelivery component initializing - Instance: ${instanceId.current}`)\n\n    // Declare jQuery and wp variables\n    const jQuery = window.jQuery\n    const wp = window.wp\n\n    // Helper function to get translation or fallback to the key\n    const getTranslation = (key) => {\n        if (typeof window.econtTranslations !== \"undefined\" && window.econtTranslations[key]) {\n            return window.econtTranslations[key]\n        }\n        return key\n    }\n\n    // Component state\n    const [iframeUrl, setIframeUrl] = useState(\"\")\n    const [globalShipmentPrices, setGlobalShipmentPrices] = useState({\n        cod: undefined,\n        cod_e: undefined,\n        no_cod: undefined,\n    })\n    const [isEditing, setIsEditing] = useState(true)\n    const [localShippingMethod, setLocalShippingMethod] = useState(null)\n    const [isEcontSelected, setIsEcontSelected] = useState(false)\n    const [portalContainer, setPortalContainer] = useState(null)\n    const [isOrderButtonDisabled, setIsOrderButtonDisabled] = useState(false)\n    const [isIframeLoading, setIsIframeLoading] = useState(true)\n\n    // Refs\n    const isMountedRef = useRef(true)\n    const messageListenerRef = useRef(null)\n    const econtContainerRef = useRef(null)\n    const ajaxInProgressRef = useRef(false) // Prevent duplicate AJAX requests\n    const lastFormDataRef = useRef(null) // Track last form data to prevent duplicates\n\n    // Get data from WooCommerce store\n    const { billingData, shippingData, cartData, selectedShippingMethod } = useSelect((select) => {\n        debugLog(\"STORE\", `useSelect hook called - Instance: ${instanceId.current}`)\n        const store = select(\"wc/store/cart\")\n        if (!store) {\n            return {\n                billingData: {},\n                shippingData: {},\n                cartData: {},\n                selectedShippingMethod: null,\n            }\n        }\n\n        let billing = {},\n            shipping = {},\n            cart = {},\n            shippingMethod = null\n\n        try {\n            // Try new API first\n            billing = store.getCustomerData()?.billing || {}\n            shipping = store.getCustomerData()?.shipping || {}\n            const cartData = store.getCartData()\n\n            // Calculate total weight from cart items\n            const totalWeight = cartData.itemsWeight * 0.001\n            const finalWeight = totalWeight > 0 ? totalWeight : 1\n\n            cart = {\n                total: Number.parseFloat(cartData.totals?.total_items) / 100 || 0,\n                currency: store.getCartTotals()?.currency_code || \"BGN\",\n                weight: finalWeight,\n            }\n\n            const shippingRates = store.getShippingRates()\n            shippingMethod = shippingRates?.[0]?.shipping_rates?.find((rate) => rate.selected)?.method_id\n        } catch (e) {\n            try {\n                // Fallback to older API\n                billing = store.getBillingData() || {}\n                shipping = store.getShippingData() || {}\n            } catch (e2) {\n                // Silently fail\n            }\n        }\n\n        return {\n            billingData: billing,\n            shippingData: shipping,\n            cartData: cart,\n            selectedShippingMethod: shippingMethod,\n        }\n    }, [])\n\n    const { setBillingAddress, setShippingAddress } = useDispatch(\"wc/store/cart\")\n\n    // Function to check if Econt shipping is selected\n    const isEcontShippingSelected = () => {\n        // First check the local state\n        if (localShippingMethod && localShippingMethod.includes(\"econt\")) {\n            debugLog(\"CHECK\", \"Econt found in local shipping method\", localShippingMethod)\n            return true\n        }\n\n        // Then check the store state\n        if (\n            selectedShippingMethod &&\n            (selectedShippingMethod === \"delivery_with_econt\" || selectedShippingMethod.includes(\"econt\"))\n        ) {\n            debugLog(\"CHECK\", \"Econt found in selected shipping method\", selectedShippingMethod)\n            return true\n        }\n\n        // Check the DOM directly\n        const econtRadio = document.querySelector('input[name^=\"shipping_method\"][value*=\"econt\"]:checked')\n        if (econtRadio) {\n            debugLog(\"CHECK\", \"Econt radio button found checked in DOM\", econtRadio.value)\n            return true\n        }\n\n        // Check if we have an iframe URL\n        if (iframeUrl && iframeUrl.length > 0) {\n            debugLog(\"CHECK\", \"Econt detected via iframe URL\", iframeUrl)\n            return true\n        }\n\n        return false\n    }\n\n    // Function to find the shipping option container\n    const findShippingOptionContainer = () => {\n        const selectors = [\n            \"#shipping-option\",\n            \".wc-block-components-shipping-rates-control\",\n            \".shipping_method\",\n            \".woocommerce-shipping-methods\",\n            \"#shipping_method\",\n        ]\n\n        for (const selector of selectors) {\n            const element = document.querySelector(selector)\n            if (element) {\n                debugLog(\"DOM\", `Found shipping container with selector: ${selector}`)\n                return element\n            }\n        }\n\n        debugLog(\"DOM\", \"No shipping container found\")\n        return null\n    }\n\n    // Function to create a portal container after shipping options\n    const createPortalContainerAfterShippingOption = () => {\n        if (!isMountedRef.current) return null\n\n        // Find the shipping option element\n        const targetElement = findShippingOptionContainer()\n        if (!targetElement) return null\n\n        // Check if we already have a portal container\n        let container = document.getElementById(\"econt-portal-container\")\n\n        // If no container exists, create one\n        if (!container) {\n            debugLog(\"PORTAL\", \"Creating new portal container\")\n            container = document.createElement(\"div\")\n            container.id = \"econt-portal-container\"\n            // Insert after the shipping option\n            if (targetElement.nextSibling) {\n                targetElement.parentNode.insertBefore(container, targetElement.nextSibling)\n            } else {\n                targetElement.parentNode.appendChild(container)\n            }\n        } else {\n            debugLog(\"PORTAL\", \"Using existing portal container\")\n        }\n\n        return container\n    }\n\n    // Function to disable/enable the place order button\n    const togglePlaceOrderButton = (disable) => {\n        debugLog(\"BUTTON\", `Toggling place order button - disable: ${disable}`)\n        const placeOrderButton = document.querySelector(\".wc-block-components-checkout-place-order-button\")\n\n        if (placeOrderButton) {\n            placeOrderButton.disabled = disable\n\n            // Add visual indication that the button is disabled\n            if (disable) {\n                placeOrderButton.style.opacity = \"0.5\"\n                placeOrderButton.style.cursor = \"not-allowed\"\n                placeOrderButton.title = getTranslation(\"Please complete Econt delivery details first\")\n            } else {\n                placeOrderButton.style.opacity = \"\"\n                placeOrderButton.style.cursor = \"\"\n                placeOrderButton.title = \"\"\n            }\n\n            setIsOrderButtonDisabled(disable)\n        }\n    }\n\n    // Function to get data from form and make AJAX request\n    const getDataFromForm = async () => {\n        debugLog(\"FORM\", `Getting data from form - Instance: ${instanceId.current}`)\n\n        if (!isMountedRef.current || !isEcontShippingSelected()) {\n            debugLog(\"FORM\", \"Component not mounted or Econt not selected, skipping\")\n            return\n        }\n\n        // Prevent duplicate AJAX requests\n        if (ajaxInProgressRef.current) {\n            debugLog(\"FORM\", \"AJAX request already in progress, skipping\")\n            return\n        }\n\n        // Wait a moment for fields to be available\n        await new Promise((resolve) => setTimeout(resolve, 100))\n\n        // Get customer data from form\n        const customerData = {\n            first_name:\n                document.querySelector(\"#shipping-first_name\")?.value ||\n                document.querySelector(\"#billing-first_name\")?.value ||\n                \"\",\n            last_name:\n                document.querySelector(\"#shipping-last_name\")?.value ||\n                document.querySelector(\"#billing-last_name\")?.value ||\n                \"\",\n            company:\n                document.querySelector(\"#shipping-company\")?.value || document.querySelector(\"#billing-company\")?.value || \"\",\n            address_1:\n                document.querySelector(\"#shipping-address_1\")?.value ||\n                document.querySelector(\"#billing-address_1\")?.value ||\n                \"\",\n            city: document.querySelector(\"#shipping-city\")?.value || document.querySelector(\"#billing-city\")?.value || \"\",\n            postcode:\n                document.querySelector(\"#shipping-postcode\")?.value || document.querySelector(\"#billing-postcode\")?.value || \"\",\n            phone: document.querySelector(\"#shipping-phone\")?.value || document.querySelector(\"#billing-phone\")?.value || \"\",\n            email:\n                document.querySelector(\"#email\")?.value ||\n                document.querySelector(\"#shipping-email\")?.value ||\n                document.querySelector(\"#billing-email\")?.value ||\n                \"\",\n        }\n\n        debugLog(\"FORM\", \"Customer data extracted\", customerData)\n\n        // Check if we have enough data\n        if (!customerData.first_name || !customerData.city) {\n            debugLog(\"FORM\", \"Insufficient customer data, retrying in 1 second\")\n            if (isMountedRef.current) {\n                setTimeout(getDataFromForm, 1000)\n            }\n            return\n        }\n\n        // Process address information\n        let isOfficeDelivery = false\n        let officeName = \"\"\n        let streetAddress = \"\"\n\n        if (customerData.address_1) {\n            if (customerData.address_1.includes(\"Delivery to office:\")) {\n                isOfficeDelivery = true\n                officeName = customerData.address_1.replace(\"Delivery to office:\", \"\").trim()\n            } else if (customerData.address_1.includes(\"Delivery to address:\")) {\n                streetAddress = customerData.address_1.replace(\"Delivery to address:\", \"\").trim()\n            } else {\n                streetAddress = customerData.address_1\n            }\n        }\n\n        // Prepare request params\n        const params = {\n            customer_name: `${customerData.first_name} ${customerData.last_name}`.trim(),\n            customer_company: customerData.company,\n            customer_address: streetAddress,\n            customer_city_name: customerData.city,\n            customer_post_code: customerData.postcode,\n            customer_phone: customerData.phone,\n            customer_email: customerData.email,\n            office_name: isOfficeDelivery ? officeName : \"\",\n        }\n\n        // Remove empty values\n        Object.keys(params).forEach((key) => {\n            if (!params[key]) delete params[key]\n        })\n\n        // Add cart data\n        const cartParams = {\n            ...params,\n            order_total: cartData.total || 0,\n            order_currency: cartData.currency || \"BGN\",\n            pack_count: 1,\n            order_weight: cartData.weight,\n        }\n\n        // Check if this is the same as the last request to prevent duplicates\n        const formDataString = JSON.stringify(cartParams)\n        if (lastFormDataRef.current === formDataString) {\n            debugLog(\"FORM\", \"Same form data as last request, skipping AJAX\")\n            return\n        }\n\n        lastFormDataRef.current = formDataString\n        ajaxInProgressRef.current = true\n\n        try {\n            debugLog(\"AJAX\", \"Making AJAX request\", cartParams)\n\n            // Make AJAX request\n            if (typeof jQuery !== \"undefined\") {\n                // Set loading state when making the request\n                setIsIframeLoading(true)\n\n                const response = await jQuery.ajax({\n                    type: \"POST\",\n                    url: window.econtData.ajaxUrl,\n                    dataType: \"json\",\n                    data: {\n                        action: \"woocommerce_delivery_with_econt_get_orderinfo\",\n                        security: window.econtData.nonce,\n                        params: cartParams,\n                    },\n                })\n\n                debugLog(\"AJAX\", \"AJAX response received\", response)\n\n                if (!response) {\n                    debugLog(\"AJAX\", \"No response received\")\n                    return\n                }\n\n                // Process URL\n                let url\n                if (typeof response === \"string\") {\n                    url = response.split('\"').join(\"\").replace(/\\\\\\//g, \"/\")\n                } else if (typeof response === \"object\") {\n                    url = response.toString()\n                } else {\n                    debugLog(\"AJAX\", \"Invalid response type\")\n                    return\n                }\n\n                // Set locale and build full URL\n                const locale = document.documentElement.lang.split(\"-\")[0] || \"en\"\n                const validLocales = [\"bg\", \"en\", \"gr\", \"ro\"]\n                const fullUrl = `${url}&module=onecheckout&lang=${validLocales.includes(locale) ? locale : \"bg\"}`\n\n                debugLog(\"AJAX\", \"Final URL constructed\", fullUrl)\n\n                // Update iframe with URL only if it's different\n                if (fullUrl !== iframeUrl) {\n                    updateIframeWithUrl(fullUrl, true)\n                } else {\n                    debugLog(\"IFRAME\", \"URL unchanged, skipping iframe update\")\n                    setIsIframeLoading(false)\n                }\n            }\n        } catch (error) {\n            debugLog(\"AJAX\", \"AJAX request failed\", error)\n            setIsIframeLoading(false)\n        } finally {\n            ajaxInProgressRef.current = false\n        }\n    }\n\n    // Function to update iframe URL and visibility\n    const updateIframeWithUrl = (url, isVisible = true) => {\n        debugLog(\"IFRAME\", `Updating iframe with URL: ${url}, visible: ${isVisible}`)\n\n        if (!isMountedRef.current) return\n\n        // Update state\n        setIframeUrl(url)\n        setIsIframeLoading(true)\n\n        // Apply URL to iframe element\n        setTimeout(() => {\n            if (!isMountedRef.current) return\n\n            const iframe = document.querySelector(\"#delivery_with_econt_iframe\")\n            if (iframe) {\n                debugLog(\"IFRAME\", \"Iframe element found, setting src\")\n                iframe.src = url\n\n                if (isVisible) {\n                    iframe.style.display = \"block\"\n                    iframe.style.visibility = \"visible\"\n                    iframe.style.height = \"500px\"\n                }\n\n                // Add load event listener\n                iframe.onload = () => {\n                    debugLog(\"IFRAME\", \"Iframe loaded successfully\")\n                    try {\n                        const iframeDocument = iframe.contentDocument || iframe.contentWindow?.document\n                        if (isMountedRef.current) {\n                            setIsIframeLoading(false)\n                        }\n                    } catch (error) {\n                        debugLog(\"IFRAME\", \"Cross-origin iframe loaded (expected)\", error.message)\n                        if (isMountedRef.current) {\n                            setIsIframeLoading(false)\n                        }\n                    }\n                }\n\n                // Add error event listener\n                iframe.onerror = () => {\n                    debugLog(\"IFRAME\", \"Iframe failed to load\")\n                    if (isMountedRef.current) {\n                        setIsIframeLoading(false)\n                    }\n                }\n            } else if (isMountedRef.current) {\n                debugLog(\"IFRAME\", \"Iframe element not found, creating portal container and retrying\")\n                const container = createPortalContainerAfterShippingOption()\n                if (container) {\n                    setPortalContainer(container)\n                }\n                setTimeout(() => {\n                    if (isMountedRef.current) {\n                        updateIframeWithUrl(url, isVisible)\n                    }\n                }, 500)\n            }\n        }, 100)\n    }\n\n    // Handle postMessage events from iframe\n    const handleIframeMessage = async (event) => {\n        const data = event.data\n\n        // Skip if not a submission event\n        if (data.shipment_error || data.shipping_price == null || isNaN(Number(data.shipping_price)) || !data.name) {\n            return\n        }\n\n        debugLog(\"MESSAGE\", \"Processing valid shipment data\", data)\n\n        try {\n            // Set cookie for shipping price\n            document.cookie = `econt_shippment_price=${data.shipping_price}; path=/`\n\n            // Update shipping rate via AJAX\n            if (typeof jQuery !== \"undefined\") {\n                const response = await jQuery.ajax({\n                    type: \"POST\",\n                    url: window.econtData.ajaxUrl,\n                    dataType: \"json\",\n                    data: {\n                        action: \"woocommerce_delivery_with_econt_update_shipping\",\n                        security: window.econtData.nonce,\n                        shipping_data: {\n                            price: data.shipping_price,\n                            price_cod: data.shipping_price_cod,\n                            price_cod_e: data.shipping_price_cod_e,\n                            currency: data.shipping_price_currency_sign,\n                        },\n                    },\n                })\n\n                if (!response.success) {\n                    throw new Error(response.message || \"Failed to update shipping rate\")\n                }\n\n                // Store shipment prices\n                setGlobalShipmentPrices({\n                    cod: data.shipping_price_cod,\n                    cod_e: data.shipping_price_cod_e,\n                    no_cod: data.shipping_price,\n                })\n\n                // Trigger checkout update and close iframe\n                wp.data.dispatch(\"wc/store/cart\").invalidateResolutionForStoreSelector(\"getCartData\")\n                setIsEditing(false)\n                togglePlaceOrderButton(false)\n\n                // Wait for checkout to update\n                await new Promise((resolve) => setTimeout(resolve, 1000))\n\n                // Prepare address data\n                const addressData = {\n                    first_name: data.face ? data.face.split(\" \")[0] : data.name.split(\" \")[0],\n                    last_name: data.face ? data.face.split(\" \")[1] : data.name.split(\" \")[1],\n                    company: data.face ? data.name : \"\",\n                    address_1: data.address\n                        ? `${getTranslation(\"Delivery to address:\")} ${data.address}`\n                        : `${getTranslation(\"Delivery to office:\")} ${data.office_name_only}`,\n                    city: data.city_name,\n                    postcode: data.post_code,\n                    phone: data.phone,\n                    email: data.email,\n                }\n\n                // Update addresses using WooCommerce's store API or direct field updates\n                try {\n                    const store = wp.data.select(\"wc/store/cart\")\n                    const dispatch = wp.data.dispatch(\"wc/store/cart\")\n                    if (store && dispatch) {\n                        await dispatch.setBillingAddress(addressData)\n                        await dispatch.setShippingAddress(addressData)\n                    } else {\n                        // Direct field updates\n                        const fields = [\"first_name\", \"last_name\", \"company\", \"address_1\", \"city\", \"postcode\", \"phone\", \"email\"]\n                        fields.forEach((field) => {\n                            if (typeof jQuery !== \"undefined\") {\n                                jQuery(`#shipping-${field}`).val(addressData[field])\n                                jQuery(`#billing-${field}`).val(addressData[field])\n                            }\n                        })\n                    }\n                } catch (error) {\n                    // Fallback to direct field updates\n                    const fields = [\"first_name\", \"last_name\", \"company\", \"address_1\", \"city\", \"postcode\", \"phone\", \"email\"]\n                    fields.forEach((field) => {\n                        if (typeof jQuery !== \"undefined\") {\n                            jQuery(`#shipping-${field}`).val(addressData[field])\n                            jQuery(`#billing-${field}`).val(addressData[field])\n                        }\n                    })\n                }\n\n                setIsEditing(false)\n                setIsIframeLoading(false)\n                togglePlaceOrderButton(false)\n            }\n        } catch (error) {\n            debugLog(\"MESSAGE\", \"Error processing message\", error)\n            setIsEditing(false)\n            setIsIframeLoading(false)\n            togglePlaceOrderButton(true)\n        }\n    }\n\n    // Effect to check shipping method changes and update component state\n    useEffect(() => {\n        debugLog(\"EFFECT\", `Shipping method check effect triggered - Instance: ${instanceId.current}`)\n\n        // Check if shipping method has changed\n        const checkShippingMethod = () => {\n            const isEcont = isEcontShippingSelected()\n            setIsEcontSelected(isEcont)\n\n            // Update local shipping method if store method changes\n            if (selectedShippingMethod && selectedShippingMethod !== localShippingMethod) {\n                debugLog(\"EFFECT\", \"Updating local shipping method\", {\n                    old: localShippingMethod,\n                    new: selectedShippingMethod,\n                })\n                setLocalShippingMethod(selectedShippingMethod)\n            }\n\n            if (isEcont) {\n                debugLog(\"EFFECT\", \"Econt is selected, setting up portal and getting form data\")\n                // Create portal container if needed\n                const container = createPortalContainerAfterShippingOption()\n                if (container) {\n                    setPortalContainer(container)\n                }\n\n                // Set editing mode if needed\n                if (!iframeUrl) {\n                    setIsEditing(true)\n                    togglePlaceOrderButton(true)\n                }\n\n                getDataFromForm()\n            } else {\n                debugLog(\"EFFECT\", \"Econt not selected, enabling place order button\")\n                togglePlaceOrderButton(false)\n                setIsIframeLoading(false)\n            }\n        }\n\n        // Initial check\n        checkShippingMethod()\n\n        // Set up event listener for shipping method changes\n        const handleShippingMethodChange = () => {\n            debugLog(\"EVENT\", \"Shipping method change event triggered\")\n            checkShippingMethod()\n        }\n\n        // Add event listeners for shipping method changes\n        if (typeof jQuery !== \"undefined\") {\n            debugLog(\"EVENT\", \"Adding jQuery event listeners\")\n            jQuery(document.body).on(\"updated_checkout\", handleShippingMethodChange)\n            jQuery('input[name^=\"shipping_method\"]').on(\"change\", handleShippingMethodChange)\n        }\n\n        // Clean up event listeners\n        return () => {\n            debugLog(\"EVENT\", \"Cleaning up shipping method event listeners\")\n            if (typeof jQuery !== \"undefined\") {\n                jQuery(document.body).off(\"updated_checkout\", handleShippingMethodChange)\n                jQuery('input[name^=\"shipping_method\"]').off(\"change\", handleShippingMethodChange)\n            }\n        }\n    }, [selectedShippingMethod, localShippingMethod, billingData, shippingData, cartData, iframeUrl])\n\n    // Effect to update portal container when shipping method changes\n    useEffect(() => {\n        if (isEcontSelected) {\n            const container = createPortalContainerAfterShippingOption()\n            if (container) {\n                setPortalContainer(container)\n            }\n            // If Econt is selected but we don't have shipping data yet, disable the button\n            if (isEditing && !globalShipmentPrices.no_cod) {\n                togglePlaceOrderButton(true)\n            }\n        } else {\n            // If Econt is not selected, make sure the button is enabled\n            togglePlaceOrderButton(false)\n        }\n    }, [isEcontSelected, isEditing, globalShipmentPrices])\n\n    // Effect to set up message event listener\n    useEffect(() => {\n        debugLog(\"EFFECT\", `Setting up message event listener - Instance: ${instanceId.current}`)\n        messageListenerRef.current = handleIframeMessage\n        window.addEventListener(\"message\", handleIframeMessage)\n\n        return () => {\n            debugLog(\"EFFECT\", `Cleaning up message event listener - Instance: ${instanceId.current}`)\n            window.removeEventListener(\"message\", handleIframeMessage)\n            messageListenerRef.current = null\n        }\n    }, [])\n\n    // Effect to clean up on unmount\n    useEffect(() => {\n        return () => {\n            debugLog(\"CLEANUP\", `Component unmounting - Instance: ${instanceId.current}`)\n            isMountedRef.current = false\n\n            // Clean up any event listeners\n            if (typeof jQuery !== \"undefined\") {\n                jQuery(document.body).off(\"updated_checkout\")\n                jQuery('input[name^=\"shipping_method\"]').off(\"change\")\n            }\n\n            // Remove message event listener\n            if (messageListenerRef.current) {\n                window.removeEventListener(\"message\", messageListenerRef.current)\n                messageListenerRef.current = null\n            }\n\n            // Remove portal container\n            const container = document.getElementById(\"econt-portal-container\")\n            if (container) {\n                container.remove()\n            }\n\n            // Make sure the place order button is enabled when component unmounts\n            togglePlaceOrderButton(false)\n        }\n    }, [])\n\n    // Effect to handle checkout updates and ensure button state is correct\n    useEffect(() => {\n        const handleCheckoutUpdate = () => {\n            // If Econt is selected and we're still editing (no shipping data yet), disable the button\n            if (isEcontSelected && isEditing && !globalShipmentPrices.no_cod) {\n                togglePlaceOrderButton(true)\n            } else if (!isEcontSelected) {\n                // If Econt is not selected, make sure the button is enabled\n                togglePlaceOrderButton(false)\n            }\n        }\n\n        if (typeof jQuery !== \"undefined\") {\n            jQuery(document.body).on(\"updated_checkout\", handleCheckoutUpdate)\n        }\n\n        return () => {\n            if (typeof jQuery !== \"undefined\") {\n                jQuery(document.body).off(\"updated_checkout\", handleCheckoutUpdate)\n            }\n        }\n    }, [isEcontSelected, isEditing, globalShipmentPrices])\n\n    // Prepare section title and button text\n    const defaultSectionTitleText = getTranslation(\"Econt Delivery Details\")\n    const defaultEditButtonText = getTranslation(\"Edit delivery details\")\n    const sectionTitleText = applyFilters(\"econtDelivery.editButtonText\", defaultSectionTitleText)\n    const editButtonText = applyFilters(\"econtDelivery.checkoutButtonText\", defaultEditButtonText)\n\n    // Render component content\n    const renderContent = () => {\n        debugLog(\"RENDER\", `Rendering component content - Instance: ${instanceId.current}`, {\n            isEcontSelected,\n            isEditing,\n            isIframeLoading,\n            iframeUrl: iframeUrl ? \"present\" : \"empty\",\n        })\n\n        return (\n            <div\n                className=\"econt-content-wrapper\"\n                style={{\n                    display: isEcontSelected ? \"block\" : \"none\",\n                    visibility: isEcontSelected ? \"visible\" : \"hidden\",\n                }}\n            >\n                <h3>{sectionTitleText}</h3>\n                {/* Iframe container */}\n                <div\n                    className=\"econt-iframe-container\"\n                    style={{\n                        display: isEcontSelected && isEditing ? \"block\" : \"none\",\n                        visibility: isEcontSelected && isEditing ? \"visible\" : \"hidden\",\n                    }}\n                >\n                    {/* Loading message with spinner - always visible when loading */}\n                    {isEcontSelected && isEditing && isIframeLoading && (\n                        <div\n                            className=\"econt-loading\"\n                            style={{\n                                padding: \"20px\",\n                                marginBottom: \"20px\",\n                                backgroundColor: \"#f8f9fa\",\n                                border: \"1px solid #ddd\",\n                                borderRadius: \"4px\",\n                                textAlign: \"center\",\n                            }}\n                        >\n                            <div style={{ display: \"flex\", justifyContent: \"center\", alignItems: \"center\", marginBottom: \"10px\" }}>\n                                <div\n                                    className=\"econt-spinner\"\n                                    style={{\n                                        width: \"30px\",\n                                        height: \"30px\",\n                                        border: \"4px solid rgba(0, 0, 0, 0.1)\",\n                                        borderRadius: \"50%\",\n                                        borderTop: \"4px solid #3498db\",\n                                        animation: \"econt-spin 1s linear infinite\",\n                                    }}\n                                ></div>\n                            </div>\n                            <div>{getTranslation(\"Loading Econt delivery options...\")}</div>\n                            {/* Add CSS animation for the spinner */}\n                            <style>\n                                {`\n                                @keyframes econt-spin {\n                                    0% { transform: rotate(0deg); }\n                                    100% { transform: rotate(360deg); }\n                                }\n                                `}\n                            </style>\n                        </div>\n                    )}\n                    {/* Iframe - hidden initially and while loading */}\n                    <iframe\n                        src={iframeUrl || \"about:blank\"}\n                        id=\"delivery_with_econt_iframe\"\n                        style={{\n                            marginTop: \"2rem\",\n                            width: \"100%\",\n                            minHeight: \"600px\",\n                            border: \"none\",\n                            display: isEcontSelected && isEditing && iframeUrl && !isIframeLoading ? \"block\" : \"none\",\n                            visibility: isEcontSelected && isEditing && iframeUrl && !isIframeLoading ? \"visible\" : \"hidden\",\n                        }}\n                        onLoad={() => {\n                            debugLog(\"IFRAME\", \"Iframe onLoad event triggered\")\n                            if (!iframeUrl) return\n                            const iframe = document.getElementById(\"delivery_with_econt_iframe\")\n                            if (iframe && isEcontSelected && isEditing) {\n                                setIsIframeLoading(false)\n                                iframe.style.display = \"block\"\n                                iframe.style.visibility = \"visible\"\n                                debugLog(\"IFRAME\", \"Iframe made visible after load\")\n                            }\n                        }}\n                    />\n                </div>\n                {/* Edit button */}\n                {isEcontSelected && !isEditing && (\n                    <button\n                        type=\"button\"\n                        className=\"econt-button econt-button-details\"\n                        style={{\n                            display: \"block\",\n                            visibility: \"visible\",\n                            marginBottom: \"40px\",\n                        }}\n                        onClick={() => {\n                            debugLog(\"BUTTON\", \"Edit button clicked\")\n                            setIsEditing(true)\n                            setIsIframeLoading(true)\n                            togglePlaceOrderButton(true)\n                            if (isEcontSelected && !iframeUrl) {\n                                getDataFromForm()\n                            }\n                        }}\n                    >\n                        {editButtonText}\n                    </button>\n                )}\n                {/* Message about disabled place order button */}\n                {isEcontSelected && isOrderButtonDisabled && (\n                    <div\n                        className=\"econt-button-message\"\n                        style={{\n                            marginTop: \"10px\",\n                            padding: \"10px\",\n                            backgroundColor: \"#fff9c4\",\n                            border: \"1px solid #ffd600\",\n                            borderRadius: \"4px\",\n                            fontSize: \"14px\",\n                            textAlign: \"center\",\n                        }}\n                    >\n                        {getTranslation(\"Please complete Econt delivery details before placing your order\")}\n                    </div>\n                )}\n            </div>\n        )\n    }\n\n    // If we have a portal container and Econt is selected, render through portal\n    if (portalContainer && isEcontSelected) {\n        debugLog(\"RENDER\", `Rendering through portal - Instance: ${instanceId.current}`)\n        return createPortal(\n            <div\n                ref={econtContainerRef}\n                className=\"wp-block-econt-delivery\"\n                style={{\n                    position: \"relative\",\n                    zIndex: \"10\",\n                    display: \"block\",\n                    visibility: \"visible\",\n                    opacity: \"1\",\n                    marginTop: \"20px\",\n                    marginBottom: \"32px\",\n                }}\n                data-econt-component=\"true\"\n                data-econt-shipping-selected=\"true\"\n                data-econt-iframe-url={iframeUrl ? \"loaded\" : \"not-loaded\"}\n                data-econt-iframe-loading={isIframeLoading ? \"true\" : \"false\"}\n                data-econt-instance={instanceId.current}\n            >\n                {renderContent()}\n            </div>,\n            portalContainer,\n        )\n    }\n\n    // Fallback render method if portal is not available\n    debugLog(\"RENDER\", `Rendering fallback (no portal) - Instance: ${instanceId.current}`)\n    return (\n        <div\n            ref={econtContainerRef}\n            className=\"wp-block-econt-delivery\"\n            style={{\n                position: \"relative\",\n                zIndex: isEcontSelected ? \"10\" : \"-1\",\n                display: isEcontSelected ? \"block\" : \"none\",\n                visibility: isEcontSelected ? \"visible\" : \"hidden\",\n                opacity: isEcontSelected ? \"1\" : \"0\",\n            }}\n            data-econt-component=\"true\"\n            data-econt-shipping-selected={isEcontSelected ? \"true\" : \"false\"}\n            data-econt-iframe-url={iframeUrl ? \"loaded\" : \"not-loaded\"}\n            data-econt-iframe-loading={isIframeLoading ? \"true\" : \"false\"}\n            data-econt-instance={instanceId.current}\n        >\n            {renderContent()}\n        </div>\n    )\n}\n\nexport default EcontDelivery\n","module.exports = window[\"wp\"][\"data\"];","module.exports = window[\"wp\"][\"element\"];","module.exports = window[\"wp\"][\"hooks\"];","module.exports = window[\"wp\"][\"i18n\"];","module.exports = window[\"wp\"][\"plugins\"];","module.exports = window[\"React\"];","module.exports = window[\"ReactDOM\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { __ } from '@wordpress/i18n';\nimport { registerPlugin } from '@wordpress/plugins';\nimport { useSelect } from '@wordpress/data';\nimport EcontDelivery from './EcontDelivery';\n\nconst EcontShippingContent = () => {\n    const { isEcontShippingSelected } = useSelect((select) => {\n        const store = select('wc/store/cart');\n        if (!store) {\n            return { isEcontShippingSelected: false };\n        }\n\n        // Get shipping rates\n        const shippingRates = store.getShippingRates();\n\n        // Find selected shipping rate\n        const selectedRate = shippingRates?.[0]?.shipping_rates?.find(rate => rate.selected);\n\n        return {\n            isEcontShippingSelected: selectedRate?.method_id === 'delivery_with_econt'\n        };\n    }, []);\n\n    if (!isEcontShippingSelected) {\n        return null;\n    }\n\n    return <EcontDelivery />;\n};\n\nconsole.log('Registering Econt delivery block plugin');\n\nregisterPlugin('econt-delivery-block', {\n    render: EcontShippingContent,\n    scope: 'woocommerce-checkout'\n});"],"names":["createElement","useState","useEffect","useRef","useSelect","useDispatch","applyFilters","createPortal","EcontDelivery","isDebugMode","urlParams","URLSearchParams","window","location","search","get","debugLog","category","message","data","timestamp","Date","toISOString","split","prefix","console","group","log","groupEnd","instanceId","Math","random","toString","substr","current","jQuery","wp","getTranslation","key","econtTranslations","iframeUrl","setIframeUrl","globalShipmentPrices","setGlobalShipmentPrices","cod","undefined","cod_e","no_cod","isEditing","setIsEditing","localShippingMethod","setLocalShippingMethod","isEcontSelected","setIsEcontSelected","portalContainer","setPortalContainer","isOrderButtonDisabled","setIsOrderButtonDisabled","isIframeLoading","setIsIframeLoading","isMountedRef","messageListenerRef","econtContainerRef","ajaxInProgressRef","lastFormDataRef","billingData","shippingData","cartData","selectedShippingMethod","select","store","billing","shipping","cart","shippingMethod","getCustomerData","getCartData","totalWeight","itemsWeight","finalWeight","total","Number","parseFloat","totals","total_items","currency","getCartTotals","currency_code","weight","shippingRates","getShippingRates","shipping_rates","find","rate","selected","method_id","e","getBillingData","getShippingData","e2","setBillingAddress","setShippingAddress","isEcontShippingSelected","includes","econtRadio","document","querySelector","value","length","findShippingOptionContainer","selectors","selector","element","createPortalContainerAfterShippingOption","targetElement","container","getElementById","id","nextSibling","parentNode","insertBefore","appendChild","togglePlaceOrderButton","disable","placeOrderButton","disabled","style","opacity","cursor","title","getDataFromForm","Promise","resolve","setTimeout","customerData","first_name","last_name","company","address_1","city","postcode","phone","email","isOfficeDelivery","officeName","streetAddress","replace","trim","params","customer_name","customer_company","customer_address","customer_city_name","customer_post_code","customer_phone","customer_email","office_name","Object","keys","forEach","cartParams","order_total","order_currency","pack_count","order_weight","formDataString","JSON","stringify","response","ajax","type","url","econtData","ajaxUrl","dataType","action","security","nonce","join","locale","documentElement","lang","validLocales","fullUrl","updateIframeWithUrl","error","isVisible","iframe","src","display","visibility","height","onload","iframeDocument","contentDocument","contentWindow","onerror","handleIframeMessage","event","shipment_error","shipping_price","isNaN","name","cookie","shipping_data","price","price_cod","shipping_price_cod","price_cod_e","shipping_price_cod_e","shipping_price_currency_sign","success","Error","dispatch","invalidateResolutionForStoreSelector","addressData","face","address","office_name_only","city_name","post_code","fields","field","val","checkShippingMethod","isEcont","old","new","handleShippingMethodChange","body","on","off","addEventListener","removeEventListener","remove","handleCheckoutUpdate","defaultSectionTitleText","defaultEditButtonText","sectionTitleText","editButtonText","renderContent","className","padding","marginBottom","backgroundColor","border","borderRadius","textAlign","justifyContent","alignItems","width","borderTop","animation","marginTop","minHeight","onLoad","onClick","fontSize","ref","position","zIndex","__","registerPlugin","EcontShippingContent","selectedRate","render","scope"],"sourceRoot":""}